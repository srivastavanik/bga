<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Ketcher</title>
  <link rel="stylesheet" href="https://unpkg.com/ketcher-react@2.5.1/dist/ketcher.css">
  <script src="https://unpkg.com/react@17/umd/react.production.min.js"></script>
  <script src="https://unpkg.com/react-dom@17/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/ketcher-react@2.5.1/dist/ketcher.js"></script>
  <script src="https://unpkg.com/ketcher-standalone@2.5.1/dist/ketcher-standalone.js"></script>
  <style>
    html, body {
      margin: 0;
      padding: 0;
      overflow: hidden;
      height: 100%;
      width: 100%;
    }
    #root {
      height: 100%;
      width: 100%;
    }
    .ketcher {
      height: 100%;
      width: 100%;
      display: flex;
      flex-direction: column;
    }
  </style>
</head>
<body>
  <div id="root"></div>
  <script>
    const rootElement = document.getElementById('root');
    const ketcher = window.ketcher;
    
    // Create standalone Ketcher instance
    const standalone = window.ketcherStandalone.createStandalone();
    
    // Initialize Ketcher editor
    ketcher.init({
      element: rootElement,
      staticResourcesUrl: '',  // URL for static resources
      structServiceProvider: standalone, // Use standalone service provider for client-side only mode
      buttons: [
        'new', 'open', 'save', 'undo', 'redo', 'cut', 'copy', 'paste',
        'clean', 'eraser', 'settings', 'help',
        'reaction', 'sgroup', 'charge', 'transform', 'enhanced-stereo',
        'bond-single', 'bond-double', 'bond-triple', 'bond-any', 'bond-aromatic', 'bond-hydrogen',
        'chain', 'template-0', 'template-1', 'template-2', 'template-3', 'template-4', 'template-5',
        'template-6', 'template-7',
        'atom-any', 'atom-h', 'atom-c', 'atom-n', 'atom-o', 'atom-s', 'atom-p', 'atom-f', 'atom-cl',
        'atom-br', 'atom-i'
      ],
      errorHandler: (e) => {
        console.error('Ketcher error:', e);
      }
    })
    .then((ketcher) => {
      // Make Ketcher instance available for parent frame
      window.ketcher = ketcher;
      console.log('Ketcher initialized successfully');
      
      // Expose methods for parent window
      window.setMolecule = (molString) => {
        ketcher.setMolecule(molString);
      };
      
      window.getMolecule = () => {
        return ketcher.getMolecule();
      };
      
      window.clearMolecule = () => {
        ketcher.clear();
      };
    })
    .catch((e) => {
      console.error('Failed to initialize Ketcher:', e);
      rootElement.innerHTML = `<div style="color: red; padding: 10px;">
        Error initializing Ketcher: ${e.message || 'Unknown error'}
      </div>`;
    });
  </script>
</body>
</html> 